platform_gcc_version=4.2
platform_sdk_version=@use_sdk@
host_alias=i686-apple-darwin
platform_min_version=macosx-version-min=10.6
platform_path="/Developer"
platform_os_cflags="-arch @use_arch@ -no_compact_linkedit"
platform_os_ldflags="-arch @use_arch@ -Wl,-arch,@use_arch@ -no_compact_linkedit"
platform_sdk_path="${platform_path}/SDKs/MacOSX${platform_sdk_version}.sdk"

export NM=${platform_path}/usr/bin/nm
export CPP=${platform_path}/usr/bin/cpp
export CXXCPP=${CPP}
export CPPFLAGS="-no-cpp-precomp -I${prefix}/include"
export CC=${platform_path}/usr/bin/gcc
export CFLAGS="-std=gnu89 -no-cpp-precomp -m${platform_min_version} -isysroot ${platform_sdk_path} ${platform_os_cflags}"
export LD=${platform_path}/usr/bin/ld
export LDFLAGS="-m${platform_min_version} -isysroot ${platform_sdk_path} ${platform_os_ldflags} -L${prefix}/lib"
export CXX=${platform_path}/usr/bin/g++
export CXXFLAGS="-m${platform_min_version} -isysroot ${platform_sdk_path} ${platform_os_cflags}"
export AR=${platform_path}/usr/bin/ar
export AS=${platform_path}/usr/bin/as
export STRIP=${platform_path}/usr/bin/strip
export RANLIB=${platform_path}/usr/bin/ranlib
export ACLOCAL="aclocal -I ${prefix}/share/aclocal -I @use_toolchain@/share/aclocal -I /Developer/usr/share/aclocal"
export LIBTOOL=@use_toolchain@/bin/glibtool
export LIBTOOLIZE=@use_toolchain@/bin/glibtoolize
export PKG_CONFIG_PATH=${prefix}/lib/pkgconfig:${platform_sdk_path}/usr/lib/pkgconfig
export PATH="@use_toolchain@/bin:${prefix}/bin:${platform_path}/usr/bin:/Developer/usr/bin:${PATH}"
export MACOSX_DEPLOYMENT_TARGET=10.4

# tweaks for samba
if test "${PACKAGE_NAME}" = "Samba" ; then
  # disable python support
  export PYTHON_VER=0.0
  # ios/osx-10.6 issue with collision of _MD5 exported from a system lib
  export LDFLAGS="${LDFLAGS} -Wl,-unexported_symbol,_MD5* -lc"
  # uses OPT instead of CFLAGS
  export OPT="${CFLAGS}"
  # various configure overrides
  ac_cv_header_libunwind_h=no
  ac_cv_header_execinfo_h=no
  samba_cv_SYSCONF_SC_NPROCESSORS_ONLN=no
fi

# tweaks for python
if test "${PACKAGE_NAME}" = "python" ; then
  export OPT="${CFLAGS}"
fi

# tweaks for libogg / libvorbis
if test "${PACKAGE_NAME}" = "libogg" || test "${PACKAGE_NAME}" = "libvorbis" ; then
  export CFLAGS="${CFLAGS} -O"
fi
